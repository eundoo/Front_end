# 가비지 컬렉션

> 자바스크립트는 눈에 보이지 않는 곳에서 메모리 관리를 수행한다. 끊임 없이 동작하고 모든 객체를 모니터링하고 도달 할 수 없는 객체는 삭제한다.

## 가비지 컬렉션 기준
---
> 도달가능성(어떻게든 접근하거나 사용할 수 있는 값을 의미)이 있는 값은 메모리에서 삭제되지 않는다.

1. 태생부터 도달 가능하기에 명백한 이유없이 삭제되지 않는 것들

- 현재 함수의 지역변수와 매개변수
- 중첩 함수의 체인에 있는 함수에서 사용되는 변수와 매개변수
- 전역변수
- 기타 등등

이런 값들은 root라고 부른다.

2. 루트가 참조하는 값이나 체이닝으로 루트에서 참조할 수 있는 값은 도달 가능한 값이다.

반대로 얘기하면 객체를 참조하고있다가 null로 변경하거나, 다른 객체를 참조해서..등등 아무도 참조하지 않는(도달할 수 없는) 상태가 되면 접근할 방법이 사라지기 때문에 가비지 컬렉터는 이를 메모리에서 삭제한다.

## 참조 두 개
---
```javascript
    let user = {
      name: "Nana"
    };

    let admin = user;   //admin도 Nana의 값을 갖게됨 (주소값을 갖게됨)

    user = null;

    //null로 덮었지만 admin은 여전히 그 객체를 바라보기 때문에 Nana는 메모리에서 삭제되지 않는다. 하지만 이 상태에서 admin을 다른값으로 덮어쓰면 Nana는 메모리에서 삭제된다.
```

## 연결된 객체 

이미지 

## 도달 할 수 없는 섬
---
객체들이 연결되어 섬 같은 구조를 만드는데 이 섬에 도달할 방법이 없는 경우, 섬을 구성하는 객체 전부가 메모리에서 삭제된다.

이미지

### 최적화 기법
---
- 세대별 수집
  새로운 객체 : 생성 이후 제 역할을 빠르게 수행한 후 금방쓸모가 없어짐. 가비지 컬렉터는 이런 객체를 공격적으로 메모리에서 제거
  오래된 객체 : 일정 시간 이상 동안 살아남은 객체는 오래된 객체로 분류하고 가비지 컬렉터가 덜 감시
- 점진적 수집 : JS는 가비지 컬렉션을 여러 부분으로 분리하고 각 부분을 별도로 수행하여 긴 지연을 짧은 지연 여러개로 분산시킨다. 이로써 모든 객체를 방문하고 mark하는데 많은 리소스가 사용되어 실행속도를 느리게함을 줄인다.
- 유후 시간 수집 : 실행에 주는 영향을 최소화 하기 위해 CPU가 유휴 상태일 때만 가비지 컬렉션을 실행한다.